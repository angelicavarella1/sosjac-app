import{_ as b,c as l,a as t,i as c,F as x,h as f,g as d,o as r,t as n,j as p,n as h,d as m,b as y,k as v}from"./index-Clg86yTR.js";const w={data(){return{reports:[],modalImage:null}},async mounted(){(!await this.getCurrentUser()||!await this.isAdmin())&&this.$router.push("/login"),await this.loadReports()},methods:{async getCurrentUser(){const{data:s}=await d.auth.getUser();return s.user},async isAdmin(){const s=await this.getCurrentUser();if(!s)return!1;const{data:e,error:g}=await d.from("admins").select("email").eq("email",s.email).single();return!!e},async loadReports(){const{data:s,error:e}=await d.from("denuncia").select("*").order("created_at",{ascending:!1});e?console.error("Erro ao carregar denúncias:",e):this.reports=s},async updateStatus(s){const{error:e}=await d.from("denuncia").update({status:s.status}).eq("id",s.id);e&&alert("Erro ao atualizar status")},statusColor(s){return s==="resolvido"?"lightgreen":s==="em_analise"?"orange":s==="encaminhado"?"skyblue":"red"},statusBg(s){return s==="resolvido"?"bg-green-500":s==="em_analise"?"bg-yellow-500":s==="encaminhado"?"bg-blue-500":"bg-red-500"},openImageModal(s){this.modalImage=s},closeImageModal(){this.modalImage=null}}},k={class:"min-h-screen bg-blue-900 text-white px-6 py-8"},_={class:"mb-6"},C={class:"max-w-6xl mx-auto"},I={key:0,class:"text-center py-10 text-gray-400"},M={key:1,class:"space-y-6"},A={class:"flex justify-between items-start mb-4"},S={class:"text-xl font-bold text-blue-200"},B=["src","onClick"],D={class:"mt-6"},R=["onUpdate:modelValue","onChange"],U={class:"relative max-w-3xl max-h-full"},V=["src"];function z(s,e,g,E,i,o){return r(),l("div",k,[t("div",_,[t("button",{onClick:e[0]||(e[0]=a=>s.$router.back()),class:"flex items-center space-x-3 px-6 py-3 bg-blue-700 hover:bg-blue-600 text-white rounded-xl shadow-lg transition-transform duration-200 transform hover:scale-105 font-semibold text-lg"},[...e[3]||(e[3]=[t("span",{class:"text-xl"},"←",-1),t("span",null,"Voltar",-1)])])]),e[11]||(e[11]=t("header",{class:"bg-blue-800 shadow-lg border-b border-blue-600 px-6 py-4 rounded-xl mb-8"},[t("h1",{class:"text-3xl font-bold text-blue-300"},"🔐 Painel do Administrador"),t("p",{class:"text-blue-200 mt-2"},"Gerencie todas as denúncias do Jardim Atlântico Central")],-1)),t("main",C,[e[10]||(e[10]=t("h2",{class:"text-2xl font-semibold mb-6 text-blue-300"},"📋 Denúncias Recebidas",-1)),i.reports.length===0?(r(),l("div",I,[...e[4]||(e[4]=[t("p",null,"Nenhuma denúncia registrada no momento.",-1)])])):(r(),l("div",M,[(r(!0),l(x,null,f(i.reports,a=>(r(),l("div",{key:a.id,class:"bg-blue-800 rounded-xl p-6 shadow-lg border border-blue-600 hover:bg-blue-750 transition"},[t("div",A,[t("h3",S,n(a.titulo),1),t("span",{style:h({color:o.statusColor(a.status)}),class:p(["px-3 py-1 rounded-full text-sm font-medium bg-opacity-20",o.statusBg(a.status)])},n(a.status),7)]),t("p",null,[e[5]||(e[5]=t("strong",null,"Categoria:",-1)),m(" "+n(a.categoria),1)]),t("p",null,[e[6]||(e[6]=t("strong",null,"Morador:",-1)),m(" "+n(a.email_usuario),1)]),t("p",null,[e[7]||(e[7]=t("strong",null,"Data:",-1)),m(" "+n(new Date(a.created_at).toLocaleString("pt-BR")),1)]),a.url_foto?(r(),l("img",{key:0,src:a.url_foto,alt:"Foto da denúncia",class:"mt-4 rounded-lg max-w-full shadow-md border border-blue-500",onClick:u=>o.openImageModal(a.url_foto)},null,8,B)):c("",!0),t("div",D,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-blue-200 mb-2"},"Atualizar Status",-1)),y(t("select",{"onUpdate:modelValue":u=>a.status=u,onChange:u=>o.updateStatus(a),class:"w-full px-4 py-3 border border-blue-500 rounded-lg bg-blue-700 text-white focus:ring-2 focus:ring-blue-400 outline-none"},[...e[8]||(e[8]=[t("option",{value:"registrado"},"Registrado",-1),t("option",{value:"em_analise"},"Em análise",-1),t("option",{value:"encaminhado"},"Encaminhado",-1),t("option",{value:"resolvido"},"Resolvido",-1)])],40,R),[[v,a.status]])])]))),128))]))]),i.modalImage?(r(),l("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 p-4",onClick:e[2]||(e[2]=(...a)=>o.closeImageModal&&o.closeImageModal(...a))},[t("div",U,[t("img",{src:i.modalImage,alt:"Ampliada",class:"max-w-full max-h-screen rounded-lg shadow-2xl"},null,8,V),t("button",{onClick:e[1]||(e[1]=(...a)=>o.closeImageModal&&o.closeImageModal(...a)),class:"absolute top-4 right-4 text-white bg-red-600 hover:bg-red-500 rounded-full w-10 h-10 flex items-center justify-center text-2xl font-bold"}," × ")])])):c("",!0)])}const N=b(w,[["render",z]]);export{N as default};
