import{_ as f,c as l,a as t,t as i,i as c,F as b,h as p,g as r,o as n,j as h,n as w,d as m,b as v,k as y}from"./index-Bqm-g8iD.js";import{_}from"./favicon-Bhvs0SYa.js";const C={data(){return{user:null,reports:[],modalImage:null}},async mounted(){const{data:s}=await r.auth.getUser();this.user=s.user,(!await this.getCurrentUser()||!await this.isAdmin())&&this.$router.push("/login"),await this.loadReports()},methods:{async getCurrentUser(){const{data:s}=await r.auth.getUser();return s.user},async isAdmin(){const s=await this.getCurrentUser();if(!s)return!1;const{data:e,error:x}=await r.from("admins").select("email").eq("email",s.email).single();return!!e},async loadReports(){const{data:s,error:e}=await r.from("denuncia").select("*").order("created_at",{ascending:!1});e?console.error("Erro ao carregar denúncias:",e):this.reports=s},async updateStatus(s){const{error:e}=await r.from("denuncia").update({status:s.status}).eq("id",s.id);e&&alert("Erro ao atualizar status")},statusColor(s){return s==="resolvido"?"lightgreen":s==="em_analise"?"orange":s==="encaminhado"?"skyblue":"red"},statusBg(s){return s==="resolvido"?"bg-green-500":s==="em_analise"?"bg-yellow-500":s==="encaminhado"?"bg-blue-500":"bg-red-500"},openImageModal(s){this.modalImage=s},closeImageModal(){this.modalImage=null},async handleLogout(){await r.auth.signOut(),this.$router.push("/login")},async banirUsuario(s){const{error:e}=await r.from("perfis").update({status:"banido",motivo_banimento:"Violação das regras do aplicativo",data_banimento:new Date().toISOString()}).eq("email",s);e?alert("Erro ao banir usuário"):(alert(`${s} foi banido com sucesso.`),await this.loadReports())}}},k={class:"bg-blue-800 text-white shadow-lg px-6 py-4 fixed top-0 left-0 right-0 z-50 flex items-center justify-between"},S={class:"flex items-center space-x-4"},I={class:"text-sm"},A={class:"min-h-screen bg-blue-900 pt-24 pb-8 px-6 text-white"},M={class:"text-right mb-6"},U={class:"max-w-6xl mx-auto"},D={key:0,class:"text-center py-10 text-gray-400"},R={key:1,class:"space-y-6"},V={class:"flex justify-between items-start mb-4"},z={class:"text-xl font-bold text-blue-200"},B=["src","onClick"],E={class:"mt-6"},L=["onUpdate:modelValue","onChange"],j={class:"relative max-w-3xl max-h-full"},O=["src"];function N(s,e,x,q,d,o){var g;return n(),l(b,null,[t("header",k,[e[4]||(e[4]=t("div",{class:"flex items-center"},[t("img",{src:_,alt:"Logo SOSJAC",class:"w-8 h-8 mr-3"}),t("h1",{class:"text-xl font-bold"},"SOSJAC")],-1)),e[5]||(e[5]=t("h2",{class:"text-lg font-semibold flex-1 text-center"},"🔐 Painel do Administrador",-1)),t("div",S,[t("span",I,"Olá, "+i((g=d.user)==null?void 0:g.email),1),t("button",{onClick:e[0]||(e[0]=(...a)=>o.handleLogout&&o.handleLogout(...a)),class:"bg-red-600 hover:bg-red-500 text-white text-sm px-3 py-1 rounded-lg"}," Sair ")])]),t("main",A,[t("div",M,[t("button",{onClick:e[1]||(e[1]=a=>s.$router.back()),class:"flex items-center space-x-2 ml-auto px-6 py-3 bg-blue-700 hover:bg-blue-600 text-white rounded-xl shadow-lg transition-transform duration-200 transform hover:scale-105 font-semibold"},[...e[6]||(e[6]=[t("span",null,"←",-1),t("span",null,"Voltar",-1)])])]),e[14]||(e[14]=t("header",{class:"bg-blue-800 shadow-lg border-b border-blue-600 px-6 py-4 rounded-xl mb-8"},[t("h1",{class:"text-3xl font-bold text-blue-300"},"🔐 Painel do Administrador"),t("p",{class:"text-blue-200 mt-2"},"Gerencie todas as denúncias do Jardim Atlântico Central")],-1)),t("div",U,[e[13]||(e[13]=t("h2",{class:"text-2xl font-semibold mb-6 text-blue-300"},"📋 Denúncias Recebidas",-1)),d.reports.length===0?(n(),l("div",D,[...e[7]||(e[7]=[t("p",null,"Nenhuma denúncia registrada no momento.",-1)])])):(n(),l("div",R,[(n(!0),l(b,null,p(d.reports,a=>(n(),l("div",{key:a.id,class:"bg-blue-800 rounded-xl p-6 shadow-lg border border-blue-600 hover:bg-blue-750 transition"},[t("div",V,[t("h3",z,i(a.titulo),1),t("span",{style:w({color:o.statusColor(a.status)}),class:h(["px-3 py-1 rounded-full text-sm font-medium bg-opacity-20",o.statusBg(a.status)])},i(a.status),7)]),t("p",null,[e[8]||(e[8]=t("strong",null,"Categoria:",-1)),m(" "+i(a.categoria),1)]),t("p",null,[e[9]||(e[9]=t("strong",null,"Morador:",-1)),m(" "+i(a.email_usuario),1)]),t("p",null,[e[10]||(e[10]=t("strong",null,"Data:",-1)),m(" "+i(new Date(a.created_at).toLocaleString("pt-BR")),1)]),a.url_foto?(n(),l("img",{key:0,src:a.url_foto,alt:"Foto da denúncia",class:"mt-4 rounded-lg max-w-full shadow-md border border-blue-500",onClick:u=>o.openImageModal(a.url_foto)},null,8,B)):c("",!0),t("div",E,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-blue-200 mb-2"},"Atualizar Status",-1)),v(t("select",{"onUpdate:modelValue":u=>a.status=u,onChange:u=>o.updateStatus(a),class:"w-full px-4 py-3 border border-blue-500 rounded-lg bg-blue-700 text-white focus:ring-2 focus:ring-blue-400 outline-none"},[...e[11]||(e[11]=[t("option",{value:"registrado"},"Registrado",-1),t("option",{value:"em_analise"},"Em análise",-1),t("option",{value:"encaminhado"},"Encaminhado",-1),t("option",{value:"resolvido"},"Resolvido",-1)])],40,L),[[y,a.status]])])]))),128))]))]),d.modalImage?(n(),l("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 p-4",onClick:e[3]||(e[3]=(...a)=>o.closeImageModal&&o.closeImageModal(...a))},[t("div",j,[t("img",{src:d.modalImage,alt:"Ampliada",class:"max-w-full max-h-screen rounded-lg shadow-2xl"},null,8,O),t("button",{onClick:e[2]||(e[2]=(...a)=>o.closeImageModal&&o.closeImageModal(...a)),class:"absolute top-4 right-4 text-white bg-red-600 hover:bg-red-500 rounded-full w-10 h-10 flex items-center justify-center text-2xl font-bold"}," × ")])])):c("",!0)])],64)}const P=f(C,[["render",N]]);export{P as default};
